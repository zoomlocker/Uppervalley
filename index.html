<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Storage Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Water Storage Calculator</h1>
        
        <label for="depthInput">Enter Depth Gauge Reading:</label>
        <input type="number" step="0.1" id="depthInput">
        <button onclick="calculate()">Calculate</button>
        
<div id="results">
    <div class="result-section">
        <h2>Cumulative Volume</h2>
        <div id="cumulativeVolumeCubic" class="volume-display">0 cu.ft.</div>
        <div id="cumulativeVolumeGallon" class="gallon-display">0 gallons</div>
    </div>

    <div class="result-section">
        <h2>Remaining Capacity</h2>
        <div id="remainingCapacityCubic" class="volume-display">0 cu.ft.</div>
        <div id="remainingCapacityGallon" class="gallon-display">0 gallons</div>
    </div>
</div>

    <script>
        const dataPoints = [
            { depth: 0, cumulativeVol: 0 },
            { depth: 2, cumulativeVol: 92560 },
            { depth: 4, cumulativeVol: 194773 },
            { depth: 6, cumulativeVol: 306949 },
            { depth: 8, cumulativeVol: 429544 },
            { depth: 10, cumulativeVol: 563060 },
            { depth: 12, cumulativeVol: 707822 },
            { depth: 14, cumulativeVol: 864196 },
            { depth: 14.5, cumulativeVol: 1032685 }
        ];

        let pieChart = null; 

        function calculate() {
            const inputDepth = parseFloat(document.getElementById('depthInput').value);
            const maxDepth = dataPoints[dataPoints.length - 1].depth;
            const maxVolume = dataPoints[dataPoints.length - 1].cumulativeVol;
            let interpolatedVolume = 0;

            if (inputDepth <= maxDepth && inputDepth >= 0) {
                for (let i = 1; i < dataPoints.length; i++) {
                    if (inputDepth <= dataPoints[i].depth) {
                        interpolatedVolume = dataPoints[i - 1].cumulativeVol + ((inputDepth - dataPoints[i - 1].depth) / (dataPoints[i].depth - dataPoints[i - 1].depth)) * (dataPoints[i].cumulativeVol - dataPoints[i - 1].cumulativeVol);
                        break;
                    }
                }
            }

            const remainingCapacityCubic = maxVolume - interpolatedVolume;
            const remainingCapacityGallon = remainingCapacityCubic * 7.48052;

            document.getElementById('cumulativeVolumeCubic').textContent = `${Math.round(interpolatedVolume).toLocaleString()} cu.ft.`;
            document.getElementById('cumulativeVolumeGallon').textContent = `${Math.round(interpolatedVolume * 7.48052).toLocaleString()} gallons`;
            document.getElementById('remainingCapacityCubic').textContent = `${Math.round(remainingCapacityCubic).toLocaleString()} cu.ft.`;
            document.getElementById('remainingCapacityGallon').textContent = `${Math.round(remainingCapacityGallon).toLocaleString()} gallons`;

            drawPieChart(Math.round(interpolatedVolume * 7.48052), Math.round(remainingCapacityGallon));
        }

        function drawPieChart(used, remaining) {
            const ctx = document.getElementById('volumeChart').getContext('2d');
            
            if (pieChart) {
                pieChart.destroy();
            }

            pieChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Used Volume', 'Remaining Capacity'],
                    datasets: [{
                        data: [used, remaining],
                        backgroundColor: ['#3498db', '#e74c3c']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }
    </script>
</body>
</html>
